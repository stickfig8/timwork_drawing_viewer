# DESIGN.md

본 문서는 단순 구현 결과가 아닌,
도면 탐색 인터페이스를 설계하며 어떤 문제를 정의하고,
어떤 판단 기준으로 UI/UX를 설계했는지를 정리한 문서입니다.

## 데이터 분석

제시된 metadata.json은 단순한 목록 구조가 아니라, **계층적 트리 구조**를 가진 데이터였습니다.  
전체 → 공간 → 공종 → (리전) → 리비전으로 이어지는 다단계 구조이며, 일부 공종은 regions를 가지고 있고, 일부는 리비전마다 imageTransform과 polygon이 다르게 정의되는 등 구조가 완전히 균일하지 않았습니다.

이 데이터를 그대로 사용하면:

- 필터링 로직이 복잡해지고
- 계층 탐색 시 조건 분기가 과도하게 증가하며
- 비교 가능한 도면을 판단하기 어려워지는 문제가 있었습니다.

따라서 UI 탐색을 중심으로 재구성한 정규화된 데이터 구조가 필요하다고 판단했습니다.

## 접근 방식

도면을 탐색하는 기능을 구현하기 위해서는 여러 계층으로 나뉘어진 데이터를 하나의 탐색 단위로 정규화하는 작업이 필요했습니다.

이전에 진행했던 **블로그 프로젝트**에서, 카테고리·태그 등 여러 계층으로 나뉜 게시물 데이터를 **Flat 구조**로 **정규화**하여 경로 시스템을 구현한 경험이 있었습니다.
이번 과제 역시 동일한 접근이 적합하다고 판단했습니다.

이를 위해 다음과 같은 탐색 전용 타입을 정의했습니다.

```ts
export type FlatRow = {
  id: string;
  drawingId: string;
  drawingName: string;

  discipline?: string;
  region?: string;

  revision?: string;
  date?: string;

  image: string;

  isBase: boolean;

  relativeTo?: string;
  scale?: number;

  description?: string;
  changes?: string[];
};
```

이 타입은 “UI 탐색에 필요한 최소 단위”를 기준으로 설계되었습니다.

하나의 도면 이미지 = 하나의 FlatRow

- Base 도면과 Revision 도면을 **동일한 배열** 안에서 관리
- 비교 기능을 위해 relativeTo 정보를 포함
- 검색 및 정렬을 위해 discipline, region, revision, date를 선택적으로 포함

이렇게 정규화한 후, metadata.json을 순회하여 모든 도면을 FlatRow[]로 변환하는 전처리 과정을 거쳤습니다.

이 방식의 장점

- 필터링 로직 단순화
- 정렬 및 검색 속도 향상
- 비교 가능 도면 판별 로직 구현 용이
- UI와 데이터 계층 구조 분리

이후 단계에서는

1. FlatData 기반 검색 필터링 시스템 구현
2. 비교 가능 도면 판별 로직 설계
3. 도면 뷰어 및 오버레이 기능 개발

순서로 개발을 진행했습니다.

## UI 설계 결정

도면 뷰어라는 주제가 주어졌을 때 가장 먼저 떠올린 형태는 **지도 UI 패턴**이었습니다. 넓은 뷰포트를 중심으로 도면을 배치하고, 좌측 **사이드바에서 공간·공종·리전·리비전을 탐색하는 구조**가 도면의 특성과 가장 잘 맞는다고 판단했습니다. 도면은 세부 요소가 많고 가로 비율이 크기 때문에, **최대한 넓은 화면을 확보**하는 것이 우선이라고 생각했습니다.

다만, 사이드바에 모든 정보를 담는 방식은 정보 밀도를 높이고 시각적 피로를 유발할 수 있다고 보았습니다. 이에 따라 현재 선택된 도면과 비교 중인 도면은 **별도의 선택 도면 네비게이터**로 분리했습니다. 또한 **뷰어 영역과의 간섭을 최소화하기** 위해 **드래그 가능**한 형태로 구현하여, 사용자가 상황에 따라 **위치를 조정**할 수 있도록 했습니다.

대안으로는 **상단 헤더 기반 필터 UI**도 고려했습니다. 이 방식은 모바일 대응에 유리하고 레이아웃이 단순해진다는 장점이 있지만, **데스크톱 환경에서 상단 공간을 차지하는 구조는 도면 열람에 방해**가 될 수 있다고 판단했습니다. 향후 모바일 뷰를 확장한다면, 뷰포트 비율에 따라 다른 형태의 유틸리티 바를 제공하는 방향이 적절하다고 생각합니다.

또한 선택 도면 네비게이터를 사이드바 내부의 탭 형태로 구현하는 방법도 고민했습니다. 하지만 현장 사용자의 시나리오를 고려했을 때, **빠른 검색과 동시에 도면 정보를 확인해야 하는 상황이 많다고 판단**하여, 검색 영역과 선택 도면 관리 영역을 물리적으로 분리하는 방식을 채택했습니다.

## 기술 선택

**선택된 도면과 비교 상태는 여러 컴포넌트에서 공유되**어야 했기 때문에 전역 상태 관리가 필요했습니다. **Zustand**를 사용해 구조를 단순하게 유지하면서도 직관적인 상태 흐름을 구성했습니다. 또한 선택 도면은 새로고침이나 브라우저/탭 이동에 영향을 받지 않도록 메모리 기반 상태로 관리했습니다.

현재는 로컬 JSON 기반 데이터이지만, 실제 서비스 환경에서 API가 연동된다면 **React Query**를 도입해 서버 상태 캐싱, 동기화 등을 처리할 계획입니다.

구조적 분리를 위해 검색, 정렬, 도면 제어 등 각 기능 단위로 **커스텀 훅**을 분리하여 책임을 명확히 하여 독립성을 최대한 유지하고자 하였습니다.

스타일링은 빠른 UI 구축과 일관성을 위해 **Tailwind**와 **shadcn**을 사용했습니다.

추가로 **eslint**와 **prettier**를 도입하여 코드 스타일의 일관성과 가독성을 유지하고자 하였습니다.

## 어려웠던 점 및 개선 방안

가장 어려웠던 부분은 **데이터 정규화**와 **비교 가능한 도면 판별 로직**이었습니다.
특히 **04 101동 지상1층 평면도 구조** 도면은 공종 단계에서 고유 이미지를 가지는 유일 케이스로, 상위 도면(01 건축)과도 비교 가능하고 자신의 리전/리비전과도 비교가 가능했습니다. 그러나 상위 그룹(01 계열)과 하위 그룹(04 리전 계열)은 서로 직접 비교할 수 없었기 때문에, 선택된 도면을 기준으로 교집합 관계를 계산하여 비교 가능 여부를 판단하는 로직을 별도로 설계해야 했습니다.

시간이 더 주어진다면 UI 개선보다 **데이터 구조 정제**와 **관계 모델링**을 더욱 고도화하고 싶습니다. metadata는 다양한 계층과 예외 케이스를 포함하고 있어, 이를 완전히 일반화된 형태로 재구성한다면 더 정교한 필터링, 비교 그룹 자동 분류, 이미지 정렬 및 폴리곤 렌더링 기능까지 확장할 수 있을 것이라 생각합니다.

## 소감

프론트엔드 개발자로서 반려동물 동반 장소, 블로그 포스트 등 다양한 데이터를 다뤄왔지만, 건축 도면처럼 공간적 관계와 버전 흐름을 동시에 고려해야 하는 데이터는 처음이었습니다. 단순히 화면을 구성하는 것을 넘어, 복잡한 계층과 관계를 해석하고 이를 사용자에게 자연스러운 탐색 흐름으로 전달하는 과정이 매우 즐거웠습니다.

특히 도면 간의 정렬 관계(relativeTo)와 리전/리비전 구조를 이해하며 데이터 모델을 설계하는 시간이 인상 깊었습니다. 더불어 일반적인 웹 서비스와 달리, 확대/축소, 드래그 이동, 오버레이 비교, 폴리곤 표시와 같은 뷰어 특화 기능을 직접 구현하면서 ***도면을 본다***는 행위 자체를 어떻게 UX로 풀어낼 것인지 고민해볼 수 있었습니다. 단순 리스트 기반 UI가 아닌, 실제 작업 환경을 가정한 인터랙션을 설계하는 경험이 흥미로웠습니다.

이번 과제를 통해 **데이터를 어떻게 보여줄 것인가**보다 **데이터를 어떻게 이해할 것인가**가 더 중요하다는 점을 다시 느꼈습니다. 아직 완전히 다듬지 못한 부분도 많지만, 실제 현업 환경에서 더 깊이 있는 구조 설계와 사용자 경험 개선을 경험해보고 싶습니다.

기회가 주어진다면 팀과 함께 문제를 정의하고, 더 정교한 인터페이스와 안정적인 구조를 만들어가는 과정에 적극적으로 참여하고 싶습니다.

감사합니다.
